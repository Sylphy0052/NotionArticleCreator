# CLAUDE CODE CODEX PAIR TEMPLATE

Claude CodeとCodex CLIを併用したTDD開発テンプレートプロジェクト

## 概要

このプロジェクトは、Claude CodeとCodex CLIを並行利用し、テスト駆動開発（TDD）を実践するためのテンプレートです。Red→Green→Refactorサイクルを徹底し、相互レビューによる品質向上を目指します。

## 特徴

- **TDD徹底**: すべての機能はテストファーストで開発
- **相互レビュー**: Claude CodeとCodex CLIによる双方向レビュー
- **パッチベース開発**: 全変更を差分提案→承認→適用で管理

## プロジェクト構造

```text
.
├── .claude/           # Claude Code設定
├── .codex/            # Codex CLI設定
├── docs/              # プロジェクト仕様書
│   └── spec.md        # メイン仕様書
├── AGENTS.md          # エージェント定義
├── CLAUDE.md          # Claude Code運用規約
├── HOW_TO_USE.md      # 使用方法ガイド
└── README.md          # このファイル
```

## セットアップ

### 環境要件

- Claude Code CLI
- Codex CLI

## 開発ワークフロー

### 基本TDDサイクル

このプロジェクトでは以下のTDDワークフローを推奨しています：

1. **Red**: 失敗テストを作成
2. **Green**: 最小実装でテストを通す
3. **Refactor**: 外部挙動を変えずコードを整理
4. **Review**: 相互レビューで品質向上
5. **Next**: 次のタスクへ継続

### 詳細な内部フロー

#### 開発フェーズ

1. **flow-init** - 目標読込・タスク分解・Redテスト計画
   - 要件を小さなタスクに分解
   - テスト計画の策定
   - 実装範囲の明確化

2. **tests-red** - 失敗テストの追加
   - 期待される動作を先にテストで定義
   - 必ず失敗することを確認

3. **tests-green** - 最小実装で成功させる
   - テストが通る最小限のコードを実装
   - 冗長性や最適化は後回し

4. **tests-refactor** - 外部挙動を変えず整理
   - コードの可読性と保守性を向上
   - テストは変更せず、実装のみ改善

5. **reviewer/codex-review** - 相互レビュー
   - Claude Code ↔ Codex CLI 双方向でレビュー
   - 設計・境界値・セキュリティ等を検証

6. **flow-next** - 次タスクへ継続
   - 完了タスクの確認
   - 次の開発サイクルへ移行

#### パッチベース開発の考え方

全ての変更は **パッチ提案→承認→適用** の手順を必須とします：

- **最小実装原則**: テストで要求された範囲のみ実装
- **明示的差分**: 常に unified diff で変更内容を提案
- **可逆性保証**: ロールバック手順を含める
- **自動化徹底**: テスト・Lint・型チェックを自動実行

#### 相互レビューシステム

Claude Code と Codex CLI を併用した双方向レビューにより、以下を実現：

- **多角的視点**: 異なるAIモデルによる検証
- **品質向上**: 設計・境界値・セキュリティの多重チェック  
- **学習効果**: 相互の提案から最適解を導出

### 役割定義

各フェーズでは以下の専門役割が機能します：

- **planner**: 要件を小タスク化、実装戦略の策定
- **tdd-coach**: TDD順守の強制、テスト品質の監視
- **reviewer**: 設計・境界値・セキュリティ等の包括レビュー
- **scaffold**: 雛形・最小構成生成、初期セットアップ
- **spec-writer**: 要件をPRD化、仕様書の整備
- **doc-writer**: ドキュメント更新、API文書化
- **codex-bridge**: Codex実行結果の要約と比較分析

### 出力形式と品質管理

#### 標準出力形式

- **差分表示**: unified diff 形式
- **変更理由**: 実装背景と影響範囲の説明
- **ロールバック手順**: 変更取り消し方法の明記
- **テスト結果**: pytest / codex run tests の実行結果

#### 品質チェック項目

- **テストカバレッジ**: 新機能は100%カバレッジ必須
- **型安全性**: mypy による厳格な型チェック
- **コード品質**: flake8 によるスタイルチェック
- **セキュリティ**: 機密情報の露出防止
- **パフォーマンス**: 必要に応じてプロファイリング実施

### フロー制御と継続性

#### 状態管理

- 各フェーズの完了状態を明確に管理
- 前フェーズの成果物を次フェーズに確実に引き継ぎ
- 異常終了時の復旧手順を事前定義

#### 品質ゲート

- 各フェーズ完了時に品質基準をクリアしていることを確認
- 基準未達時は前フェーズに戻って修正
- 最終的な統合テストで全体品質を保証

## 運用規約

詳細な運用規約は以下のファイルを参照してください：

- `CLAUDE.md`: Claude Code運用規約とTDDワークフロー
- `AGENTS.md`: エージェント定義
- `HOW_TO_USE.md`: 使用方法ガイド
